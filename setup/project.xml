<project name="Open PEAR Server" version="1.1.0" pathinfo="index.php">
    <description>
        共用のPEAR Channelリポジトリサービス
    </description>
    <database name="openpear">
        <table name="package">
            <column name="id" />
            <column name="name" unique="true" require="true" chartype="/^[A-Za-z][A-Za-z0-9_]+$/" />
            <column name="description" type="text" require="true" />
            <column name="public" type="bool" default="1" />
            <column name="latestRelease" type="text" />
            <column name="created" type="timestamp" default="sysdate" />
            <column name="updated" type="timestamp" default="sysdate" />
        </table>
        <table name="maintainer">
            <column name="id" />
            <column name="name" unique="true" require="true" max="20" chartype="/^[A-Za-z0-9_\-]+$/" />
            <column name="mail" type="mail" />
            <column name="fullname" max="30" />
            <column name="profile" type="text" />
            <column name="password" require="true" />
            <column name="created" type="timestamp" default="sysdate" />
        </table>
        <table name="open_id">
            <column name="maintainer" type="int" reference="maintainer.id" uniquewith="url" />
            <column name="url" unique="true" require="true" type="string" uniquewith="maintainer" />
        </table>

        <table name="repository_log">
            <column name="revision" type="int" />
            <column name="author" type="string" />
            <column name="package" type="int" reference="package.id" />
            <column name="log" type="text" />
            <column name="diff" type="text" />
            <column name="date" type="timestamp" />
        </table>

        <table name="release">
            <column name="package" type="int" primary="true" reference="package.id" />
            
            <column name="project_src_dir" label="[プロジェクト]ソース格納先" default="src" chartype="^[A-Za-z0-9\.\/\_\-]+$" />
            <column name="project_release_dir" label="[プロジェクト]パッケージ格納先" default="release" chartype="^[A-Za-z0-9\.\/\_\-]+$" />
            
            <column name="package_package_name" label="[パッケージ]パッケージ名" require="true" />
            <column name="package_package_type" default="php" label="[パッケージ]パッケージタイプ" />
            <column name="package_baseinstalldir" label="[パッケージ]インストール先" chartype="^[A-Za-z0-9\.\/\_\-]+$" />
            <column name="package_channel" default="openpear.org" label="[パッケージ]チャンネル" />
            <column name="package_summary" type="text" label="[パッケージ]概要" />
            <column name="package_description" type="text" label="[パッケージ]詳細説明" />
            <column name="package_notes" type="text" label="[パッケージ]更新履歴" />
            <extra name="package_summary_file" label="[パッケージ]概要(ファイル)" default="summary.txt" />
            <extra name="package_description_file" label="[パッケージ]詳細説明(ファイル)" default="desc.txt" />
            <extra name="package_notes_file" label="[パッケージ]更新履歴(ファイル)" default="notes.txt" />
            
            <column name="version_release_ver" default="1.0.0" label="[バージョン]リリースバージョン" chartype="^[0-9\.]+$" />
            <column name="version_release_stab" default="stable" label="[バージョン]リリース状態">
                <choices>
                    <data>stable</data>
                    <data>beta</data>
                    <data>alpha</data>
                </choices>
            </column>
            <column name="version_api_ver" default="1.0.0" label="[バージョン]APIバージョン" chartype="^[0-9\.]+$" />
            <column name="version_api_vapi_stab" default="stable" label="[バージョン]API状態">
                <choices>
                    <data>stable</data>
                    <data>beta</data>
                    <data>alpha</data>
                </choices>
            </column>
            <column name="version_php_min" default="5.2.0" label="[バージョン]PHPバージョン（最小）" chartype="^[0-9\.]+$" />
            <column name="version_pear_min" default="1.7.2" label="[バージョン]PEARインストーラ（最小）" chartype="^[0-9\.]+$" />
            
            <column name="license_name" default="New BSD Licence" label="[ライセンス]ライセンス名" />
            <column name="license_uri" default="http://creativecommons.org/licenses/BSD/" label="[ライセンス]ライセンス参照先" />
            
            <!-- __call とかである程度面倒みてやるしかないのではないか -->
            <!-- role はseliarizeしましょうかね -->
            <column name="role" type="text" label="[拡張子]拡張子毎のタイプの指定" />
            <column name="file" type="text" label="[ファイル]" />
            <column name="dep" type="text" label="[パッケージ依存関係]" />
            <column name="installer" type="text" label="[インストーラ]" />
        </table>

        <table name="newproject_queue">
            <column name="id" />
            <column name="package" type="int" reference="package.id" />
            <column name="maintainer" type="int" reference="maintainer.id" />
            <column name="mail_possible" type="bool" default="true" />
            <column name="created" type="timestamp" default="sysdate" />
        </table>
        <table name="release_queue">
            <column name="id" />
            <column name="package" type="int" reference="package.id" />
            <column name="maintainer" type="int" reference="maintainer.id" />
            <column name="revision" type="int" />
            <column name="build_path" require="true" />
            <column name="build_conf" type="text" />
            <column name="mail_possible" type="bool" default="true" />
            <column name="created" type="timestamp" default="sysdate" />
        </table>

        <table name="favorite">
            <column name="package" type="int" reference="package.id" uniquewith="maintainer" />
            <column name="maintainer" type="int" reference="maintainer.id" uniquewith="package" />
        </table>
        <map name="charge">
            <column name="id" />
            <column name="package" type="int" reference="package.id" uniquewith="maintainer" />
            <column name="maintainer" type="int" reference="maintainer.id" uniquewith="package" />
            <column name="role">
                <choices>
                    <data caption="lead">lead</data>
                    <data caption="developer">developer</data>
                    <data caption="contributor">contributor</data>
                    <data caption="helper">helper</data>
                </choices>
            </column>
        </map>
    </database>
    <database name="server">
        <table name="categories" class="server_categories">
            <column name="name" type="string" />
            <column name="desctn" type="text" />
        </table>
        <table name="maintainers" class="server_maintainers">
            <column name="hundle" type="string" size="30" />
            <column name="fullname" size="100" />
            <column name="email" size="100" />
            <column name="stats" size="10" />
        </table>
        <table name="packages" class="server_packages">
            <column name="channel" size="100" />
            <column name="date" size="30" />
            <column name="dependencies" type="text" />
            <column name="description" type="text" />
            <column name="licenselocation" type="text" />
            <column name="maintainers" type="text" />
            <column name="name" size="100" />
            <column name="notes" type="text" />
            <column name="package" size="100" />
            <column name="stability" type="text" />
            <column name="state" size="10" />
            <column name="summary" type="text" />
            <column name="version" size="10" />
            <column name="filesize" size="10" />
            <column name="contents" type="text" />
        </table>
    </database>
    <input name="CHANNEL">
        <title>Channel DOMAIN</title>
        <data>openpear.org</data>
    </input>
    <input name="SVN_PATH">
        <title>Subversionのディレクトリ</title>
        <data>/home/openpear/svn/openpear</data>
    </input>
    <input name="SVN_ACCESS_FILE">
        <title>AuthzSVNAccessFile</title>
        <data>/home/openpear/svn/openpear.access</data>
    </input>
    <input name="SVN_AUTH_FILE">
        <title>AuthUserFile</title>
        <data>/home/openpear/svn/openpear.passwd</data>
    </input>
    <input name="WORKING_DIR">
        <title>作業用ディレクトリ</title>
        <description>パッケージングに使用する一時ディレクトリ</description>
        <data>{$rhaco.path()}work/build</data>
    </input>
    <input name="SVN_URL">
        <title>Subversion のURL</title>
        <data>http://svn.openpear.org/</data>
    </input>
    <input name="INFORMATION">
        <title>information</title>
        <data>Welcome to openpear.org</data>
    </input>
    
    <input name="GMAIL_ACCOUNT">
        <title>Gmail Account</title>
        <data>notify@openpear.org</data>
    </input>
    <password name="GMAIL_PASSWORD">
        <title>Gmail Password</title>
    </password>
</project>
